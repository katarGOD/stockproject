(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bfc22650"],{"0caf":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},o=[];n._withStripped=!0;a("ac6a");var s={data:function(){return{departmentOptions:[]}},created:function(){var t=this;t.$database.collection("department").orderBy("code").get().then(function(e){e.forEach(function(e){t.departmentOptions.push({id:e.id,data:e.data(),value:e.id,label:"".concat(e.data().code," : ").concat(e.data().description),model:!1})})})}},i=s,r=a("2877"),c=Object(r["a"])(i,n,o,!1,null,null,null);c.options.__file="departmentOptions.vue";e["a"]=c.exports},"1bab":function(t,e,a){},2508:function(t,e,a){"use strict";var n,o,s=a("f490"),i={methods:{FormatDate:function(t,e){var a=s["d"].formatDate(t,e);return a}}},r=i,c=a("2877"),l=Object(c["a"])(r,n,o,!1,null,null,null);l.options.__file="formatDate.vue";e["a"]=l.exports},"4c2b":function(t,e,a){"use strict";var n=a("1bab"),o=a.n(n);o.a},da0d:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},o=[];n._withStripped=!0;a("ac6a");var s={data:function(){return{positionOptions:[]}},created:function(){var t=this;t.$database.collection("position").get().then(function(e){e.forEach(function(e){t.positionOptions.push({id:e.id,data:e.data(),value:e.id,label:"".concat(e.data().code," : ").concat(e.data().jobTitleEnglish),model:!1})})})}},i=s,r=a("2877"),c=Object(r["a"])(i,n,o,!1,null,null,null);c.options.__file="positionOptions.vue";e["a"]=c.exports},e135:function(t,e,a){"use strict";a("551c");var n,o,s={data:function(){return{userInfo:{}}},methods:{getUserInfo:function(t){var e=this;return new Promise(function(a){e.$database.collection("authUser").doc(t).get().then(function(t){return t.exists?a(t.data()):a({})})})}}},i=s,r=a("2877"),c=Object(r["a"])(i,n,o,!1,null,null,null);c.options.__file="userInfo.vue";e["a"]=c.exports},ed52:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-between gutter-lg"},[a("div",{staticClass:"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-xs-12"},[a("q-table",{attrs:{data:t.authUser,pagination:t.pagination,loading:t.loading,columns:t.columns,"visible-columns":t.visibleColumns,filter:t.filter,"row-key":".key"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-left",fn:function(e){return[a("q-search",{attrs:{"hide-underline":"",color:"secondary"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-right",fn:function(e){return[a("q-datetime",{attrs:{type:"date"},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})]}},{key:"body",fn:function(e){return a("q-tr",{staticClass:"cursor-pointer",attrs:{props:e},nativeOn:{click:function(a){t.rowClick(e.row)}}},t._l(e.cols,function(n){return a("q-td",{key:n.name,attrs:{props:e}},["photo"===n.name?[t.todayLastClock(e.key)?[t.todayLastClock(e.key).photo?a("img",{staticClass:"center center-cropped-photo",attrs:{src:t.todayLastClock(e.key).photo}}):a("img",{staticClass:"center center-cropped-photo",attrs:{src:n.value}})]:n.value?[a("img",{staticClass:"center center-cropped-photo",attrs:{src:n.value}})]:[a("img",{staticClass:"center center-cropped-photo",attrs:{src:"/statics/no-avatar.png"}})]]:"mapImage"===n.name?[t.todayLastClock(e.key)?[t.todayLastClock(e.key).mapImage?a("img",{staticClass:"center center-cropped-map",attrs:{src:t.todayLastClock(e.key).mapImage}}):t._e()]:t._e()]:"status"===n.name?[t.todayInTimeUser(e.key)?a("q-btn",{staticClass:"q-mr-sm",attrs:{color:"primary",icon:"access_time",label:t.todayInTimeUser(e.key)}}):t._e(),a("br"),a("br"),t.todayOutTimeUser(e.key)?a("q-btn",{staticClass:"q-mr-sm",attrs:{color:"deep-orange",icon:"av_timer",label:t.todayOutTimeUser(e.key)}}):t._e(),t.todayLeaveUser(e.key)?a("q-btn",{staticClass:"q-mr-sm",attrs:{color:"green",icon:"timer_off",label:t.todayLeaveUser(e.key)}}):t._e(),t.isHoliday(t.selectedDate)?a("q-btn",{staticClass:"q-mr-sm",attrs:{color:"red",icon:"event",label:t.findHolidayName(t.selectedDate)}}):t._e()]:[t._v("\n            "+t._s(n.value)+"\n          ")]],2)}))}}])})],1),a("q-modal",{attrs:{maximized:"","content-css":{padding:"20px"}},model:{value:t.formModal,callback:function(e){t.formModal=e},expression:"formModal"}},[a("div",{staticClass:"row justify-center",staticStyle:{"padding-bottom":"25px"}},[a("q-btn",{attrs:{round:"",icon:"close"},on:{click:function(e){t.formModal=!1}}})],1),a("div",{staticClass:"row justify-center gutter-lg"},[a("div",{staticClass:"col-xl-4 col-lg-4 col-md-4 col-sm12 col-xs-12"},[a("div",{staticClass:"q-headline"},[t._v(t._s(t.$t("Clock info")))]),t.selected.length?[a("ul",[a("li",[t._v(t._s(t.selected[0].firstName)+" "+t._s(t.selected[0].lastName))]),a("li",[t._v(t._s(t._.find(t.departmentOptions,{value:t.selected[0].department}).label))])]),a("img",{staticClass:"center center-cropped-photo",attrs:{src:t.selected[0].photo}})]:t._e()],2),a("div",{staticClass:"col-xl-8 col-lg-8 col-md-8 col-sm12 col-xs-12"},[t.selected.length?t._l(t.todayClockTimeUser(t.selected[0][".key"]),function(e){return a("div",{key:e.id,staticClass:"row justify-start",staticStyle:{padding:"10px"}},[a("div",{staticClass:"col-xl-3 col-lg-3 col-md-12 col-sm-12 col-xs-12"},["in"===e.clockAction?a("q-btn",{attrs:{icon:"access_time",color:"primary",label:t.FormatDate(e.timestamp,"YYYY-MM-DD HH:mm")}}):"out"===e.clockAction?a("q-btn",{attrs:{icon:"av_timer",color:"orange",label:t.FormatDate(e.timestamp,"YYYY-MM-DD HH:mm")}}):a("q-btn",{attrs:{icon:"person_pin_circle",color:"brown",label:t.FormatDate(e.timestamp,"YYYY-MM-DD HH:mm")}})],1),a("div",{staticClass:"col-xl-5 col-lg-5 col-md-12 col-sm-12 col-xs-12"},[a("img",{staticClass:"center center-cropped-photo",staticStyle:{width:"300px"},attrs:{src:e.mapImage}})]),a("div",{staticClass:"col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12"},[a("q-editor",{attrs:{disable:e.authUser!=t.userId},model:{value:e.note,callback:function(a){t.$set(e,"note",a)},expression:"clock.note"}}),e.authUser===t.userId?a("q-btn",{attrs:{icon:"save"},on:{click:function(a){t.saveNote(e.id,e.note)}}}):t._e()],1)])}):t._e()],2)])])],1)},o=[];n._withStripped=!0;a("96cf");var s=a("c973"),i=a.n(s),r=a("3156"),c=a.n(r),l=(a("6762"),a("2fdb"),a("7514"),a("ac6a"),a("551c"),a("f490")),d=a("2f62"),u=a("e135"),m=a("da0d"),f=a("0caf"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},p=[];h._withStripped=!0;var y={data:function(){return{absenceTypeOptions:[]}},methods:{getAbsenceTypeOptions:function(){var t=this;return new Promise(function(e){var a=t,n=[];a.$database.collection("leaveAndAbsenceTypes").orderBy("index").get().then(function(t){return t.forEach(function(t){n.push({value:t.id,index:t.data().index,label:t.data().description,id:t.id,code:t.data().code,entitlement:t.data().entitlement,data:t.data()})}),e(n)}).catch(function(t){console.log(t)})})}},created:function(){var t=i()(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,e.getAbsenceTypeOptions();case 3:e.absenceTypeOptions=t.sent;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},v=y,g=a("2877"),b=Object(g["a"])(v,h,p,!1,null,null,null);b.options.__file="absenceTypeOptions.vue";var _=b.exports,D=a("2508"),k={name:"dashboard",mixins:[u["a"],m["a"],_,f["a"],D["a"]],data:function(){return{userInfo:{},holidays:[],holidaysName:[],todayTimeAttendanceList:[],todayLeaveRequestList:[],WRKH:8,collectionSize:0,pagination:{sortBy:"firstName",descending:!1,rowsPerPage:50},columns:[{name:"photo",label:this.$t("Photo"),field:"photo",sortable:!1,align:"center"},{name:"mapImage",label:this.$t("Map"),field:"mapImage",sortable:!1,align:"left"},{name:"firstName",label:this.$t("First name"),field:"firstName",sortable:!0,align:"left"},{name:"lastName",label:this.$t("Last name"),field:"lastName",sortable:!0,align:"left"},{name:"status",label:this.$t("Status"),field:"status",sortable:!1,align:"left"}],visibleColumns:["photo","mapImage","firstName","lastName","status"],selected:[],filter:"",loading:!0,formModal:!1,selectedDate:new Date}},firestore:function(){return{authUser:this.$database.collection("authUser").where("active","==",!0)}},methods:{get_WRKH:function(){var t=this;return new Promise(function(e){var a=t,n=8;a.$database.collection("initialSetup").where("code","==","_WRKH").limit(1).get().then(function(t){return t.forEach(function(t){n=t.data().value}),e(n)})})},getTodayTimeAttendanceList:function(){var t=this;return new Promise(function(e){var a=t;a.$database.collection("timeAttendance").where("timestamp",">=",a.todayStart).where("timestamp","<=",a.todayEnd).get().then(function(t){var a=[];return t.forEach(function(t){a.push({id:t.id,authUser:t.data().authUser,photo:t.data().photo,mapImage:t.data().mapImage,clockAction:t.data().clockAction,timestring:l["d"].formatDate(t.data().timestamp,"YYYYMMDDHHmm"),timestamp:t.data().timestamp,platform:t.data().platform,note:t.data().note})}),e(a)})})},findHolidayName:function(t){var e="",a=this,n=parseInt(l["d"].formatDate(t,"DDD"));return e=a._.find(a.holidaysName,{date:n})?a._.find(a.holidaysName,{date:n}).holiday:"Holiday",e},getPublicHolidays:function(){var t=this;return new Promise(function(e){var a=t,n=[],o=parseInt(l["d"].formatDate(a.selectedDate,"YYYY")),s=parseInt(l["d"].formatDate(a.selectedDate,"YYYY"));a.$database.collection("publicHolidays").where("year",">=",o).where("year","<=",s).get().then(function(t){return t.forEach(function(t){n.push(parseInt(l["d"].formatDate(t.data().date,"DDD")))}),e(n)})})},getPublicHolidaysName:function(){var t=this;return new Promise(function(e){var a=t,n=[],o=parseInt(l["d"].formatDate(a.selectedDate,"YYYY")),s=parseInt(l["d"].formatDate(a.selectedDate,"YYYY"));a.$database.collection("publicHolidays").where("year",">=",o).where("year","<=",s).get().then(function(t){return t.forEach(function(t){n.push({date:parseInt(l["d"].formatDate(t.data().date,"DDD")),holiday:t.data().holiday})}),e(n)})})},getTodayLeaveRequestList:function(){var t=this;return new Promise(function(e){var a=t;a.$database.collection("leaveRequest").where("datesRequestedFrom","<=",a.todayStart).where("yearOfPosting","==",parseInt(l["d"].formatDate(Date.now(),"YYYY"))).get().then(function(t){var n=[];return t.forEach(function(t){t.data().requestDate.to>=a.todayStart&&n.push({id:t.id,authUser:t.data().authUser,absenceType:t.data().absenceType})}),e(n)})})},clockInOut:function(){this.$router.push("/my-account/time-clock")},loadingStatus:function(){var t=this;t.$firestore.authUser.get().then(function(e){t.collectionSize=e.size,t.loading=!1})},todayClockTimeUser:function(t){var e=this,a="",n=e._.filter(e.todayTimeAttendanceList,{authUser:t});return a=e._.orderBy(n,["timestamp"],["asc"]),a},todayInTimeUser:function(t){var e=this,a="",n=e._.filter(e.todayTimeAttendanceList,{authUser:t,clockAction:"in"}),o=e._.orderBy(n,["timestamp"],["asc"]);return o.length&&(a="".concat(l["d"].formatDate(o[0].timestamp,"HH:mm:ss"))),a},todayOutTimeUser:function(t){var e=this,a="",n=e._.filter(e.todayTimeAttendanceList,{authUser:t,clockAction:"out"}),o=e._.orderBy(n,["timestamp"],["desc"]);return o.length&&(a="".concat(l["d"].formatDate(o[0].timestamp,"HH:mm:ss"))),a},todayLeaveUser:function(t){var e=this,a="",n=e._.filter(e.todayLeaveRequestList,{authUser:t});return n.length&&(a="".concat(e._.find(e.absenceTypeOptions,{value:n[0].absenceType})?e._.find(e.absenceTypeOptions,{value:n[0].absenceType}).label:"Leave")),a},todayLastInTimeUser:function(t){var e=this,a="",n=e._.filter(e.todayTimeAttendanceList,{authUser:t,clockAction:"in"}),o=e._.orderBy(n,["timestamp"],["desc"]);return o.length&&(a=o[0]),a},todayLastClock:function(t){var e=this,a="",n=e._.filter(e.todayTimeAttendanceList,{authUser:t}),o=e._.orderBy(n,["timestamp"],["desc"]);return o.length&&(a=o[0]),a},rowClick:function(t){this.formModal=!0,this.selected=[t]},isHoliday:function(t){if(t){var e=parseInt(l["d"].formatDate(t,"DDD")),a=this,n=!1;return isNaN(e)||a._.includes(a.holidays,e)&&(n=!0),n}},saveNote:function(t,e){var a=this;a.$database.collection("timeAttendance").doc(t).update({note:e}).then(function(){a.$q.notify({message:a.$t("Form submitted successfully"),type:"positive",icon:"info"})}).catch(function(t){a.$q.notify(a.$t("Error writing document")),console.error("Error writing document: ",t)})}},computed:c()({},Object(d["c"])(["applicationName","userId","userAccount"]),{userName:function(){var t="";return this.userInfo&&(t="".concat(this.userInfo.firstName," ").concat(this.userInfo.lastName)),t},position:function(){var t="";if(this.userInfo){var e=this._.find(this.positionOptions,{value:this.userInfo.position});e&&(t=e.data.code)}return t},userImage:function(){var t="/statics/no-avatar.png";return this.userInfo&&this.userInfo.photo&&(t=this.userInfo.photo),t},thisYear:function(){return parseInt(l["d"].formatDate(new Date(this.selectedDate),"YYYY"))},thisMonth:function(){return parseInt(l["d"].formatDate(new Date(this.selectedDate),"M"))},today:function(){return parseInt(l["d"].formatDate(new Date(this.selectedDate),"D"))},todayStart:function(){return l["d"].buildDate({year:this.thisYear,month:this.thisMonth,date:this.today,hours:0,minutes:0,seconds:0})},todayEnd:function(){return l["d"].buildDate({year:this.thisYear,month:this.thisMonth,date:this.today,hours:23,minutes:59,seconds:59})},todayClockIn:function(){var t=[],e=this._.filter(this.todayTimeAttendanceList,{authUser:this.userId,clockAction:"in"});return t=this._.orderBy(e,["timestamp"],["asc"]),t},countIn:function(){return this.todayClockIn.length},todayInTime:function(){var t="";return this.todayClockIn.length&&(t="".concat(l["d"].formatDate(this.todayClockIn[0].timestamp,"HH:mm:ss"))),t},todayClockOut:function(){var t=[],e=this._.filter(this.todayTimeAttendanceList,{authUser:this.userId,clockAction:"out"});return t=this._.orderBy(e,["timestamp"],["desc"]),t},countOut:function(){return this.todayClockOut.length},todayOutTime:function(){var t="";return this.todayClockOut.length&&(t="".concat(l["d"].formatDate(this.todayClockOut[0].timestamp,"HH:mm:ss"))),t},clockState:function(){var t=!1;return t=this.countIn>this.countOut||(this.countOut,!1),t}}),created:function(){var t=i()(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,e.$q.loading.show(),t.next=4,e.getPublicHolidays();case 4:return e.holidays=t.sent,t.next=7,e.getPublicHolidaysName();case 7:return e.holidaysName=t.sent,t.next=10,e.getUserInfo(e.userId);case 10:return e.userInfo=t.sent,t.next=13,e.getTodayTimeAttendanceList();case 13:return e.todayTimeAttendanceList=t.sent,t.next=16,this.getTodayLeaveRequestList();case 16:return this.todayLeaveRequestList=t.sent,t.next=19,e.get_WRKH();case 19:e.WRKH=t.sent,e.$q.loading.hide(),e.loadingStatus();case 22:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),watch:{selectedDate:function(){var t=i()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getTodayTimeAttendanceList();case 2:return this.todayTimeAttendanceList=t.sent,t.next=5,this.getTodayLeaveRequestList();case 5:return this.todayLeaveRequestList=t.sent,t.next=8,this.getPublicHolidays();case 8:return this.holidays=t.sent,t.next=11,this.getPublicHolidaysName();case 11:this.holidaysName=t.sent;case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},w=k,I=(a("4c2b"),Object(g["a"])(w,n,o,!1,null,null,null));I.options.__file="index.vue";e["default"]=I.exports}}]);